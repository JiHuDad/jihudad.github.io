FRRouting(FRR)의 gRPC northbound 인터페이스에 접근하는 기본 예시

---

## 1. 준비 사항

1. **gRPC C 라이브러리 설치**
   - Ubuntu:  
     ```sh
     sudo apt-get install libgrpc-dev protobuf-compiler-grpc
     ```
   - 또는 [gRPC 공식 문서](https://grpc.io/docs/languages/c/) 참고

2. **proto 파일 준비**
   - FRR의 proto 파일(예: `mgmt_pb2.proto` 또는 `mgmt.proto`)을 확보  
     (보통 `mgmtd/proto/` 디렉터리에 있음)

3. **proto → C 코드 생성**
   - [nanopb](https://jpa.kapsi.fi/nanopb/) 또는 [protobuf-c](https://github.com/protobuf-c/protobuf-c) 등 C용 protobuf 라이브러리 필요
   - gRPC C는 공식적으로 C++ API를 래핑하여 사용하므로, C++로 생성 후 C에서 래핑하는 방식이 일반적입니다.

---

## 2. 예시: C에서 gRPC 호출 (C++ 코드 래핑)

### 2.1 proto → C++ 코드 생성

```sh
protoc --grpc_out=. --plugin=protoc-gen-grpc=`which grpc_cpp_plugin` -I. mgmt.proto
protoc --cpp_out=. -I. mgmt.proto
```
- `mgmt.grpc.pb.h`, `mgmt.grpc.pb.cc`, `mgmt.pb.h`, `mgmt.pb.cc` 생성

### 2.2 C++ 코드 예시 (C에서 직접 호출은 어렵고, C++로 래핑 필요)

```cpp
// frr_grpc_client.cpp
#include <grpcpp/grpcpp.h>
#include "mgmt.grpc.pb.h"

int main() {
    // gRPC 채널 생성
    auto channel = grpc::CreateChannel("127.0.0.1:50051", grpc::InsecureChannelCredentials());
    frr::mgmt::Mgmt::Stub stub(channel);

    // SetRequest 메시지 생성
    frr::mgmt::SetRequest request;
    request.set_path("/frr-interface:lib/interface[name='eth0']/description");
    request.set_value("테스트 인터페이스");

    // 응답 객체
    frr::mgmt::SetResponse response;
    grpc::ClientContext context;

    // gRPC 호출
    grpc::Status status = stub.Set(&context, request, &response);

    if (status.ok()) {
        std::cout << "성공: " << response.DebugString() << std::endl;
    } else {
        std::cerr << "실패: " << status.error_message() << std::endl;
    }
    return 0;
}
```

### 2.3 C에서 호출하려면?

- 위 C++ 코드를 `extern "C"`로 래핑하여 C에서 함수처럼 호출
- 또는, nanopb/protobuf-c 등 pure C 라이브러리로 proto를 변환해 사용  
  (이 경우 gRPC C API를 직접 사용해야 하며, 구현이 복잡해짐)

---

## 3. C에서 gRPC 직접 사용시 참고

- gRPC C API는 내부적으로 C++로 구현되어 있습니다.
- [grpc/examples/c](https://github.com/grpc/grpc/tree/master/examples/c) 참고
- pure C로만 구현하려면, gRPC C API와 protobuf-c를 조합해야 하며,  
  proto 파일을 `protoc-c`로 변환해야 합니다.

---

## 4. 요약

- **가장 쉬운 방법**: C++로 gRPC 클라이언트 작성 후, C에서 래핑 호출
- **완전한 C만 사용**: protobuf-c + gRPC C API 조합(구현 난이도 높음)
- **라이선스 문제 없음**: gRPC와 proto 파일만 사용하면 GPL 영향 없음

---

## 5. 참고 자료

- [gRPC C++ Quick Start](https://grpc.io/docs/languages/cpp/quickstart/)
- [protobuf-c](https://github.com/protobuf-c/protobuf-c)
- [nanopb](https://jpa.kapsi.fi/nanopb/)
- [FRR gRPC northbound 공식 문서](https://docs.frrouting.org/en/latest/grpc-northbound.html)

---

### 추가 안내  
- 실제 proto 파일, 메시지 구조, 서비스 이름 등은 FRR 버전에 따라 다를 수 있습니다.  
